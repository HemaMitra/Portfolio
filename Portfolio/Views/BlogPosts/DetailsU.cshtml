@model Portfolio.Models.BlogPost
@using Microsoft.AspNet.Identity
@{
    ViewBag.Title = "Blog Details";
}
<br>
<h3 class="asmthead fade-toggle">Blog Details</h3>
<!-- SUBHEADER -->
<div class="subheader">
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-sm-8">
            </div>
            <div class="col-md-4 col-sm-4">
                <!-- Search Form -->
                <form class="blog-search">
                    <input type="text" class="form-control" id="blog-search" placeholder="Search article...">
                </form>
            </div>

        </div><!-- .row -->
    </div><!-- .container -->
</div>
<!-- SUBHEADER END -->
<!-------------------------------------------------------------------->

<div id="main" class="container">
    <div class="row">
        <div class="col-md-7 col-xs-6">

            <!-- BLOG POST -->
            <div class="blog">
                  <article class="blog-postDet">
                        <h2 class="blog-title shadow colRed"><a href="#">@Html.DisplayFor(model => model.Title)</a></h2>
                      @if (Model.MediaURL != null)
                      { 
                        <img class="img-responsive" src="@Model.MediaURL" alt="">
                      }
                      <!--<img class="blog-thumb" src="@Model.MediaURL" alt="">-->

                        <div class="blog-meta  blog-calfont">
                            <ul class="list-inline list-unstyled">
                                <li><i class="fa fa-calendar colBlack"></i>@Html.DisplayFor(model => model.Created)</li>
                                <li><i class="fa fa-comments colBlack"></i> <a href="#">@Model.Comments.Count</a></li>
                                
                                @if (User.IsInRole("Admin"))
                                {
                                    <li>@Html.ActionLink("Edit", "Edit", new { id = Model.Id })</li>
                                    <li>@Html.ActionLink("Delete", "Delete", new { id = Model.Id })</li>

                                }
                            </ul>
                        </div>
                      <div class="colBlack blog-txtSize">
                          @Html.Raw(Model.Body)
                      </div>

                      @*<div>
                          @Html.ActionLink("Back to List", "Index", null, new { @class = "btn btn-danger pull-right" })
                      </div>*@
                </article>
                </div><hr>
             @*@**************************************************************************************************
                    Comment Section Starts
             ***************************************************************************************************   *@
                <div>
                    <h5><b>@Model.Comments.Count Comments</b></h5>

                    <div>
                        @foreach (var com in @Model.Comments)
                        {
                            <div class="modal-header blog-txtSize">
                                <small class="colRed1">@User.Identity.Name</small><br>
                                @com.Body
                                <ul class="list-inline list-unstyled">
                                    @if (User.IsInRole("Admin"))
                                    {
                                        <li>@Html.ActionLink("Edit", "Edit", new { id = @com.Id })</li>
                                        <li>@Html.ActionLink("Delete Comment", "DeleteComment", new { id = @com.Id })</li>
                                    }
                                    </ul>
                            </div>
                        }
                    </div>

                 </div>
                    <!-- Main comment end -->
            
                    
                    <!-- Blog comment form -->
                    
                @if (Request.IsAuthenticated) {
                <div id="comment-form" class="comment-form">
                    <h4>Leave Comment</h4>
                    <form action="@Url.Action("CreateComment")" method="post" enctype="multipart/form-data" role="form">
                        <input type="hidden" name="PostId" value="@Model.Id" />
                        <input type="hidden" name="Slug" value="@Model.Slug" />
                        <textarea class="form-control" rows="3" placeholder="Message" name="Body"></textarea>
                            <div class="col-md-offset-2 col-md-10">
                                <input type="submit" value="Submit" class="btn btn-danger" />
                            </div>
                    </form>
                </div>
                }
                    <!-- Blog comment form end -->
                
             @***********************************************************************************************
           Comment Section Ends
    ***********************************************************************************************@

            </div>
            <!-- BLOG POST END -->



        <div class="col-md-5 col-xs-6">
       

            <div class="sidebar-wrap">
                <h3 class="sidebar-title shadow colRed">Category</h3>

                <ul class="fa-ul sidebar-list">
                    <li>
                        <i class="fa-fw fa-li fa fa-folder-open"></i>
                        <a href="@Url.Action("Category",new {Category = "MasterClass"})">
                            Master Class
                        </a>
                    </li>
                    <li>
                        <i class="fa-fw fa-li fa fa-folder-open"></i>
                        <a href="@Url.Action("Category",new {Category = "General"})">
                            General
                        </a>
                    </li>
                </ul>
            </div>

            @*For LogIn and Register *@

            <div class="sidebar-wrap">
                <h3 class="sidebar-title shadow colRed">User</h3>

                @if (Request.IsAuthenticated)
                {
                    using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
                    {
                        @Html.AntiForgeryToken()

    <div class="col-md-12 col-xs-12">

        @Html.ActionLink("Hello " + User.Identity.GetUserName() + "!", "Index", "Manage", routeValues: null, 
        htmlAttributes: new { title = "Manage" })
        <br /><br /><br>
        <a href="javascript:document.getElementById('logoutForm').submit()" class="btn btn-danger sidebar-btn">Log off</a>
    </div>
                    }
                }
                else
                {
                    <div class="col-md-12 col-xs-12">
                        @Html.ActionLink("Register", "Register", "Account", routeValues: null, htmlAttributes: new { @class = "btn btn-danger sidebar-btn" })<br /><br>
                        @Html.ActionLink("Log in", "Login", "Account", routeValues: null, htmlAttributes: new { @class = "btn btn-danger sidebar-btn" })
                        
                    </div>

                }


            </div>

            @*<div class="sidebar-wrap">
                    <h3 class="sidebar-title">Twitter Widget</h3>

                    <div id="twitter-widget" class="twitter-widget" data-widget-id="347099293930377217" data-widget-length="3"></div>
                </div>*@

        </div>
        <!-- SIDEBAR END -->

    
  </div><!-- .row -->
</div><!-- .container -->
